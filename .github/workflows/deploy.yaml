name: Deploy
on: push

 jobs:
   deployment:
     runs-on: 'ubuntu-latest'
     steps:
     - uses: actions/checkout@v1

     - name: 'Deploy'
#       uses: deliverybot/helm@v1
#       with:
#         release: 'crypto-api'
#         namespace: 'default'
#         chart: './k8s-helm/crypto-api'
#         token: '${{ github.token }}'
#         value_files: "values.yaml"
#       env:
#         KUBECONFIG_FILE: '${{ secrets.KUBECONFIG }}' 

        uses: peymanmortazavi/eks-helm-deploy@master
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS__KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: us-east-2
          cluster-name: crypt-api-eks
          config-files: ./k8s-helm/crypto-api/value.yaml
          namespace: default
          name: crypt-api-demo